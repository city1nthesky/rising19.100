#include "stdafx.h"
#include "../algorithms.h"

static  UINT64 crc64_tab[4][256] = {
	{//0
		0x0000000000000000LL,0x42F0E1EBA9EA3693LL,0x85E1C3D753D46D26LL,0xC711223CFA3E5BB5LL,0x493366450E42ECDFLL,0x0BC387AEA7A8DA4CLL,0xCCD2A5925D9681F9LL,0x8E224479F47CB76ALL,
		0x9266CC8A1C85D9BELL,0xD0962D61B56FEF2DLL,0x17870F5D4F51B498LL,0x5577EEB6E6BB820BLL,0xDB55AACF12C73561LL,0x99A54B24BB2D03F2LL,0x5EB4691841135847LL,0x1C4488F3E8F96ED4LL,
		0x663D78FF90E185EFLL,0x24CD9914390BB37CLL,0xE3DCBB28C335E8C9LL,0xA12C5AC36ADFDE5ALL,0x2F0E1EBA9EA36930LL,0x6DFEFF5137495FA3LL,0xAAEFDD6DCD770416LL,0xE81F3C86649D3285LL,
		0xF45BB4758C645C51LL,0xB6AB559E258E6AC2LL,0x71BA77A2DFB03177LL,0x334A9649765A07E4LL,0xBD68D2308226B08ELL,0xFF9833DB2BCC861DLL,0x388911E7D1F2DDA8LL,0x7A79F00C7818EB3BLL,
		0xCC7AF1FF21C30BDELL,0x8E8A101488293D4DLL,0x499B3228721766F8LL,0x0B6BD3C3DBFD506BLL,0x854997BA2F81E701LL,0xC7B97651866BD192LL,0x00A8546D7C558A27LL,0x4258B586D5BFBCB4LL,
		0x5E1C3D753D46D260LL,0x1CECDC9E94ACE4F3LL,0xDBFDFEA26E92BF46LL,0x990D1F49C77889D5LL,0x172F5B3033043EBFLL,0x55DFBADB9AEE082CLL,0x92CE98E760D05399LL,0xD03E790CC93A650ALL,
		0xAA478900B1228E31LL,0xE8B768EB18C8B8A2LL,0x2FA64AD7E2F6E317LL,0x6D56AB3C4B1CD584LL,0xE374EF45BF6062EELL,0xA1840EAE168A547DLL,0x66952C92ECB40FC8LL,0x2465CD79455E395BLL,
		0x3821458AADA7578FLL,0x7AD1A461044D611CLL,0xBDC0865DFE733AA9LL,0xFF3067B657990C3ALL,0x711223CFA3E5BB50LL,0x33E2C2240A0F8DC3LL,0xF4F3E018F031D676LL,0xB60301F359DBE0E5LL,
		0xDA050215EA6C212FLL,0x98F5E3FE438617BCLL,0x5FE4C1C2B9B84C09LL,0x1D14202910527A9ALL,0x93366450E42ECDF0LL,0xD1C685BB4DC4FB63LL,0x16D7A787B7FAA0D6LL,0x5427466C1E109645LL,
		0x4863CE9FF6E9F891LL,0x0A932F745F03CE02LL,0xCD820D48A53D95B7LL,0x8F72ECA30CD7A324LL,0x0150A8DAF8AB144ELL,0x43A04931514122DDLL,0x84B16B0DAB7F7968LL,0xC6418AE602954FFBLL,
		0xBC387AEA7A8DA4C0LL,0xFEC89B01D3679253LL,0x39D9B93D2959C9E6LL,0x7B2958D680B3FF75LL,0xF50B1CAF74CF481FLL,0xB7FBFD44DD257E8CLL,0x70EADF78271B2539LL,0x321A3E938EF113AALL,
		0x2E5EB66066087D7ELL,0x6CAE578BCFE24BEDLL,0xABBF75B735DC1058LL,0xE94F945C9C3626CBLL,0x676DD025684A91A1LL,0x259D31CEC1A0A732LL,0xE28C13F23B9EFC87LL,0xA07CF2199274CA14LL,
		0x167FF3EACBAF2AF1LL,0x548F120162451C62LL,0x939E303D987B47D7LL,0xD16ED1D631917144LL,0x5F4C95AFC5EDC62ELL,0x1DBC74446C07F0BDLL,0xDAAD56789639AB08LL,0x985DB7933FD39D9BLL,
		0x84193F60D72AF34FLL,0xC6E9DE8B7EC0C5DCLL,0x01F8FCB784FE9E69LL,0x43081D5C2D14A8FALL,0xCD2A5925D9681F90LL,0x8FDAB8CE70822903LL,0x48CB9AF28ABC72B6LL,0x0A3B7B1923564425LL,
		0x70428B155B4EAF1ELL,0x32B26AFEF2A4998DLL,0xF5A348C2089AC238LL,0xB753A929A170F4ABLL,0x3971ED50550C43C1LL,0x7B810CBBFCE67552LL,0xBC902E8706D82EE7LL,0xFE60CF6CAF321874LL,
		0xE224479F47CB76A0LL,0xA0D4A674EE214033LL,0x67C58448141F1B86LL,0x253565A3BDF52D15LL,0xAB1721DA49899A7FLL,0xE9E7C031E063ACECLL,0x2EF6E20D1A5DF759LL,0x6C0603E6B3B7C1CALL,
		0xF6FAE5C07D3274CDLL,0xB40A042BD4D8425ELL,0x731B26172EE619EBLL,0x31EBC7FC870C2F78LL,0xBFC9838573709812LL,0xFD39626EDA9AAE81LL,0x3A28405220A4F534LL,0x78D8A1B9894EC3A7LL,
		0x649C294A61B7AD73LL,0x266CC8A1C85D9BE0LL,0xE17DEA9D3263C055LL,0xA38D0B769B89F6C6LL,0x2DAF4F0F6FF541ACLL,0x6F5FAEE4C61F773FLL,0xA84E8CD83C212C8ALL,0xEABE6D3395CB1A19LL,
		0x90C79D3FEDD3F122LL,0xD2377CD44439C7B1LL,0x15265EE8BE079C04LL,0x57D6BF0317EDAA97LL,0xD9F4FB7AE3911DFDLL,0x9B041A914A7B2B6ELL,0x5C1538ADB04570DBLL,0x1EE5D94619AF4648LL,
		0x02A151B5F156289CLL,0x4051B05E58BC1E0FLL,0x87409262A28245BALL,0xC5B073890B687329LL,0x4B9237F0FF14C443LL,0x0962D61B56FEF2D0LL,0xCE73F427ACC0A965LL,0x8C8315CC052A9FF6LL,
		0x3A80143F5CF17F13LL,0x7870F5D4F51B4980LL,0xBF61D7E80F251235LL,0xFD913603A6CF24A6LL,0x73B3727A52B393CCLL,0x31439391FB59A55FLL,0xF652B1AD0167FEEALL,0xB4A25046A88DC879LL,
		0xA8E6D8B54074A6ADLL,0xEA16395EE99E903ELL,0x2D071B6213A0CB8BLL,0x6FF7FA89BA4AFD18LL,0xE1D5BEF04E364A72LL,0xA3255F1BE7DC7CE1LL,0x64347D271DE22754LL,0x26C49CCCB40811C7LL,
		0x5CBD6CC0CC10FAFCLL,0x1E4D8D2B65FACC6FLL,0xD95CAF179FC497DALL,0x9BAC4EFC362EA149LL,0x158E0A85C2521623LL,0x577EEB6E6BB820B0LL,0x906FC95291867B05LL,0xD29F28B9386C4D96LL,
		0xCEDBA04AD0952342LL,0x8C2B41A1797F15D1LL,0x4B3A639D83414E64LL,0x09CA82762AAB78F7LL,0x87E8C60FDED7CF9DLL,0xC51827E4773DF90ELL,0x020905D88D03A2BBLL,0x40F9E43324E99428LL,
		0x2CFFE7D5975E55E2LL,0x6E0F063E3EB46371LL,0xA91E2402C48A38C4LL,0xEBEEC5E96D600E57LL,0x65CC8190991CB93DLL,0x273C607B30F68FAELL,0xE02D4247CAC8D41BLL,0xA2DDA3AC6322E288LL,
		0xBE992B5F8BDB8C5CLL,0xFC69CAB42231BACFLL,0x3B78E888D80FE17ALL,0x7988096371E5D7E9LL,0xF7AA4D1A85996083LL,0xB55AACF12C735610LL,0x724B8ECDD64D0DA5LL,0x30BB6F267FA73B36LL,
		0x4AC29F2A07BFD00DLL,0x08327EC1AE55E69ELL,0xCF235CFD546BBD2BLL,0x8DD3BD16FD818BB8LL,0x03F1F96F09FD3CD2LL,0x41011884A0170A41LL,0x86103AB85A2951F4LL,0xC4E0DB53F3C36767LL,
		0xD8A453A01B3A09B3LL,0x9A54B24BB2D03F20LL,0x5D45907748EE6495LL,0x1FB5719CE1045206LL,0x919735E51578E56CLL,0xD367D40EBC92D3FFLL,0x1476F63246AC884ALL,0x568617D9EF46BED9LL,
		0xE085162AB69D5E3CLL,0xA275F7C11F7768AFLL,0x6564D5FDE549331ALL,0x279434164CA30589LL,0xA9B6706FB8DFB2E3LL,0xEB46918411358470LL,0x2C57B3B8EB0BDFC5LL,0x6EA7525342E1E956LL,
		0x72E3DAA0AA188782LL,0x30133B4B03F2B111LL,0xF7021977F9CCEAA4LL,0xB5F2F89C5026DC37LL,0x3BD0BCE5A45A6B5DLL,0x79205D0E0DB05DCELL,0xBE317F32F78E067BLL,0xFCC19ED95E6430E8LL,
		0x86B86ED5267CDBD3LL,0xC4488F3E8F96ED40LL,0x0359AD0275A8B6F5LL,0x41A94CE9DC428066LL,0xCF8B0890283E370CLL,0x8D7BE97B81D4019FLL,0x4A6ACB477BEA5A2ALL,0x089A2AACD2006CB9LL,
		0x14DEA25F3AF9026DLL,0x562E43B4931334FELL,0x913F6188692D6F4BLL,0xD3CF8063C0C759D8LL,0x5DEDC41A34BBEEB2LL,0x1F1D25F19D51D821LL,0xD80C07CD676F8394LL,0x9AFCE626CE85B507LL
	},
	{//1
		0x0000000000000000LL,0x57944fe2fc4440a1LL,0x002db5aeab065e4aLL,0x57b9fa4c57421eebLL,0x56cf24bfaa48fc35LL,0x015b6b5d560cbc94LL,0x56e29111014ea27fLL,0x0176def3fd0ae2deLL,
		0x029b6314071f2762LL,0x550f2cf6fb5b67c3LL,0x02b6d6baac197928LL,0x55229958505d3989LL,0x545447abad57db57LL,0x03c0084951139bf6LL,0x5479f2050651851dLL,0x03edbde7fa15c5bcLL,
		0xfca7a3a1a1f4d16dLL,0xab33ec435db091ccLL,0xfc8a160f0af28f27LL,0xab1e59edf6b6cf86LL,0xaa68871e0bbc2d58LL,0xfdfcc8fcf7f86df9LL,0xaa4532b0a0ba7312LL,0xfdd17d525cfe33b3LL,
		0xfe3cc0b5a6ebf60fLL,0xa9a88f575aafb6aeLL,0xfe11751b0deda845LL,0xa9853af9f1a9e8e4LL,0xa8f3e40a0ca30a3aLL,0xff67abe8f0e74a9bLL,0xa8de51a4a7a55470LL,0xff4a1e465be114d1LL,
		0x14ba8cc3b98d4b41LL,0x432ec32145c90be0LL,0x1497396d128b150bLL,0x4303768feecf55aaLL,0x4275a87c13c5b774LL,0x15e1e79eef81f7d5LL,0x42581dd2b8c3e93eLL,0x15cc52304487a99fLL,
		0x1621efd7be926c23LL,0x41b5a03542d62c82LL,0x160c5a7915943269LL,0x4198159be9d072c8LL,0x40eecb6814da9016LL,0x177a848ae89ed0b7LL,0x40c37ec6bfdcce5cLL,0x1757312443988efdLL,
		0xe81d2f6218799a2cLL,0xbf896080e43dda8dLL,0xe8309accb37fc466LL,0xbfa4d52e4f3b84c7LL,0xbed20bddb2316619LL,0xe946443f4e7526b8LL,0xbeffbe7319373853LL,0xe96bf191e57378f2LL,
		0xea864c761f66bd4eLL,0xbd120394e322fdefLL,0xeaabf9d8b460e304LL,0xbd3fb63a4824a3a5LL,0xbc4968c9b52e417bLL,0xebdd272b496a01daLL,0xbc64dd671e281f31LL,0xebf09285e26c5f90LL,
		0xd0e47c0edcd0092bLL,0x877033ec2094498aLL,0xd0c9c9a077d65761LL,0x875d86428b9217c0LL,0x862b58b17698f51eLL,0xd1bf17538adcb5bfLL,0x8606ed1fdd9eab54LL,0xd192a2fd21daebf5LL,
		0xd27f1f1adbcf2e49LL,0x85eb50f8278b6ee8LL,0xd252aab470c97003LL,0x85c6e5568c8d30a2LL,0x84b03ba57187d27cLL,0xd32474478dc392ddLL,0x849d8e0bda818c36LL,0xd309c1e926c5cc97LL,
		0x2c43dfaf7d24d846LL,0x7bd7904d816098e7LL,0x2c6e6a01d622860cLL,0x7bfa25e32a66c6adLL,0x7a8cfb10d76c2473LL,0x2d18b4f22b2864d2LL,0x7aa14ebe7c6a7a39LL,0x2d35015c802e3a98LL,
		0x2ed8bcbb7a3bff24LL,0x794cf359867fbf85LL,0x2ef50915d13da16eLL,0x796146f72d79e1cfLL,0x78179804d0730311LL,0x2f83d7e62c3743b0LL,0x783a2daa7b755d5bLL,0x2fae624887311dfaLL,
		0xc45ef0cd655d426aLL,0x93cabf2f991902cbLL,0xc4734563ce5b1c20LL,0x93e70a81321f5c81LL,0x9291d472cf15be5fLL,0xc5059b903351fefeLL,0x92bc61dc6413e015LL,0xc5282e3e9857a0b4LL,
		0xc6c593d962426508LL,0x9151dc3b9e0625a9LL,0xc6e82677c9443b42LL,0x917c699535007be3LL,0x900ab766c80a993dLL,0xc79ef884344ed99cLL,0x902702c8630cc777LL,0xc7b34d2a9f4887d6LL,
		0x38f9536cc4a99307LL,0x6f6d1c8e38edd3a6LL,0x38d4e6c26fafcd4dLL,0x6f40a92093eb8decLL,0x6e3677d36ee16f32LL,0x39a2383192a52f93LL,0x6e1bc27dc5e73178LL,0x398f8d9f39a371d9LL,
		0x3a623078c3b6b465LL,0x6df67f9a3ff2f4c4LL,0x3a4f85d668b0ea2fLL,0x6ddbca3494f4aa8eLL,0x6cad14c769fe4850LL,0x3b395b2595ba08f1LL,0x6c80a169c2f8161aLL,0x3b14ee8b3ebc56bbLL,
		0xb5ac5614ec0e6464LL,0xe23819f6104a24c5LL,0xb581e3ba47083a2eLL,0xe215ac58bb4c7a8fLL,0xe36372ab46469851LL,0xb4f73d49ba02d8f0LL,0xe34ec705ed40c61bLL,0xb4da88e7110486baLL,
		0xb7373500eb114306LL,0xe0a37ae2175503a7LL,0xb71a80ae40171d4cLL,0xe08ecf4cbc535dedLL,0xe1f811bf4159bf33LL,0xb66c5e5dbd1dff92LL,0xe1d5a411ea5fe179LL,0xb641ebf3161ba1d8LL,
		0x490bf5b54dfab509LL,0x1e9fba57b1bef5a8LL,0x4926401be6fceb43LL,0x1eb20ff91ab8abe2LL,0x1fc4d10ae7b2493cLL,0x48509ee81bf6099dLL,0x1fe964a44cb41776LL,0x487d2b46b0f057d7LL,
		0x4b9096a14ae5926bLL,0x1c04d943b6a1d2caLL,0x4bbd230fe1e3cc21LL,0x1c296ced1da78c80LL,0x1d5fb21ee0ad6e5eLL,0x4acbfdfc1ce92effLL,0x1d7207b04bab3014LL,0x4ae64852b7ef70b5LL,
		0xa116dad755832f25LL,0xf6829535a9c76f84LL,0xa13b6f79fe85716fLL,0xf6af209b02c131ceLL,0xf7d9fe68ffcbd310LL,0xa04db18a038f93b1LL,0xf7f44bc654cd8d5aLL,0xa0600424a889cdfbLL,
		0xa38db9c3529c0847LL,0xf419f621aed848e6LL,0xa3a00c6df99a560dLL,0xf434438f05de16acLL,0xf5429d7cf8d4f472LL,0xa2d6d29e0490b4d3LL,0xf56f28d253d2aa38LL,0xa2fb6730af96ea99LL,
		0x5db17976f477fe48LL,0x0a2536940833bee9LL,0x5d9cccd85f71a002LL,0x0a08833aa335e0a3LL,0x0b7e5dc95e3f027dLL,0x5cea122ba27b42dcLL,0x0b53e867f5395c37LL,0x5cc7a785097d1c96LL,
		0x5f2a1a62f368d92aLL,0x08be55800f2c998bLL,0x5f07afcc586e8760LL,0x0893e02ea42ac7c1LL,0x09e53edd5920251fLL,0x5e71713fa56465beLL,0x09c88b73f2267b55LL,0x5e5cc4910e623bf4LL,
		0x65482a1a30de6d4fLL,0x32dc65f8cc9a2deeLL,0x65659fb49bd83305LL,0x32f1d056679c73a4LL,0x33870ea59a96917aLL,0x6413414766d2d1dbLL,0x33aabb0b3190cf30LL,0x643ef4e9cdd48f91LL,
		0x67d3490e37c14a2dLL,0x304706eccb850a8cLL,0x67fefca09cc71467LL,0x306ab342608354c6LL,0x311c6db19d89b618LL,0x6688225361cdf6b9LL,0x3131d81f368fe852LL,0x66a597fdcacba8f3LL,
		0x99ef89bb912abc22LL,0xce7bc6596d6efc83LL,0x99c23c153a2ce268LL,0xce5673f7c668a2c9LL,0xcf20ad043b624017LL,0x98b4e2e6c72600b6LL,0xcf0d18aa90641e5dLL,0x989957486c205efcLL,
		0x9b74eaaf96359b40LL,0xcce0a54d6a71dbe1LL,0x9b595f013d33c50aLL,0xcccd10e3c17785abLL,0xcdbbce103c7d6775LL,0x9a2f81f2c03927d4LL,0xcd967bbe977b393fLL,0x9a02345c6b3f799eLL,
		0x71f2a6d98953260eLL,0x2666e93b751766afLL,0x71df137722557844LL,0x264b5c95de1138e5LL,0x273d8266231bda3bLL,0x70a9cd84df5f9a9aLL,0x271037c8881d8471LL,0x7084782a7459c4d0LL,
		0x7369c5cd8e4c016cLL,0x24fd8a2f720841cdLL,0x73447063254a5f26LL,0x24d03f81d90e1f87LL,0x25a6e1722404fd59LL,0x7232ae90d840bdf8LL,0x258b54dc8f02a313LL,0x721f1b3e7346e3b2LL,
		0x8d55057828a7f763LL,0xdac14a9ad4e3b7c2LL,0x8d78b0d683a1a929LL,0xdaecff347fe5e988LL,0xdb9a21c782ef0b56LL,0x8c0e6e257eab4bf7LL,0xdbb7946929e9551cLL,0x8c23db8bd5ad15bdLL,
		0x8fce666c2fb8d001LL,0xd85a298ed3fc90a0LL,0x8fe3d3c284be8e4bLL,0xd8779c2078faceeaLL,0xd90142d385f02c34LL,0x8e950d3179b46c95LL,0xd92cf77d2ef6727eLL,0x8eb8b89fd2b232dfLL,
	},
	{//2
		0x0000000000000000LL,0x7827619b17e70dc0LL,0xcd8220fd0b9693e9LL,0xb5a541661c719e29LL,0xa1d2c18aa9201c81LL,0xd9f5a011bec71141LL,0x6c50e177a2b68f68LL,0x147780ecb55182a8LL,
		0x939cab5e8c7c58f0LL,0xebbbcac59b9b5530LL,0x5e1e8ba387eacb19LL,0x2639ea38900dc6d9LL,0x324e6ad4255c4471LL,0x4a690b4f32bb49b1LL,0xffcc4a292ecad798LL,0x87eb2bb2392dda58LL,
		0x8f261f6dd123ddd2LL,0xf7017ef6c6c4d012LL,0x42a43f90dab54e3bLL,0x3a835e0bcd5243fbLL,0x2ef4dee77803c153LL,0x56d3bf7c6fe4cc93LL,0xe376fe1a739552baLL,0x9b519f8164725f7aLL,
		0x1cbab4335d5f8522LL,0x649dd5a84ab888e2LL,0xd13894ce56c916cbLL,0xa91ff555412e1b0bLL,0xbd6875b9f47f99a3LL,0xc54f1422e3989463LL,0x70ea5544ffe90a4aLL,0x08cd34dfe80e078aLL,
		0x98e15972803f9af7LL,0xe0c638e997d89737LL,0x5563798f8ba9091eLL,0x2d4418149c4e04deLL,0x393398f8291f8676LL,0x4114f9633ef88bb6LL,0xf4b1b8052289159fLL,0x8c96d99e356e185fLL,
		0x0b7df22c0c43c207LL,0x735a93b71ba4cfc7LL,0xc6ffd2d107d551eeLL,0xbed8b34a10325c2eLL,0xaaaf33a6a563de86LL,0xd288523db284d346LL,0x672d135baef54d6fLL,0x1f0a72c0b91240afLL,
		0x17c7461f511c4725LL,0x6fe0278446fb4ae5LL,0xda4566e25a8ad4ccLL,0xa26207794d6dd90cLL,0xb6158795f83c5ba4LL,0xce32e60eefdb5664LL,0x7b97a768f3aac84dLL,0x03b0c6f3e44dc58dLL,
		0x845bed41dd601fd5LL,0xfc7c8cdaca871215LL,0x49d9cdbcd6f68c3cLL,0x31feac27c11181fcLL,0x25892ccb74400354LL,0x5dae4d5063a70e94LL,0xe80b0c367fd690bdLL,0x902c6dad68319d7dLL,
		0x99ddfb35c9a459dcLL,0xe1fa9aaede43541cLL,0x545fdbc8c232ca35LL,0x2c78ba53d5d5c7f5LL,0x380f3abf6084455dLL,0x40285b247763489dLL,0xf58d1a426b12d6b4LL,0x8daa7bd97cf5db74LL,
		0x0a41506b45d8012cLL,0x726631f0523f0cecLL,0xc7c370964e4e92c5LL,0xbfe4110d59a99f05LL,0xab9391e1ecf81dadLL,0xd3b4f07afb1f106dLL,0x6611b11ce76e8e44LL,0x1e36d087f0898384LL,
		0x16fbe4581887840eLL,0x6edc85c30f6089ceLL,0xdb79c4a5131117e7LL,0xa35ea53e04f61a27LL,0xb72925d2b1a7988fLL,0xcf0e4449a640954fLL,0x7aab052fba310b66LL,0x028c64b4add606a6LL,
		0x85674f0694fbdcfeLL,0xfd402e9d831cd13eLL,0x48e56ffb9f6d4f17LL,0x30c20e60888a42d7LL,0x24b58e8c3ddbc07fLL,0x5c92ef172a3ccdbfLL,0xe937ae71364d5396LL,0x9110cfea21aa5e56LL,
		0x013ca247499bc32bLL,0x791bc3dc5e7cceebLL,0xccbe82ba420d50c2LL,0xb499e32155ea5d02LL,0xa0ee63cde0bbdfaaLL,0xd8c90256f75cd26aLL,0x6d6c4330eb2d4c43LL,0x154b22abfcca4183LL,
		0x92a00919c5e79bdbLL,0xea876882d200961bLL,0x5f2229e4ce710832LL,0x2705487fd99605f2LL,0x3372c8936cc7875aLL,0x4b55a9087b208a9aLL,0xfef0e86e675114b3LL,0x86d789f570b61973LL,
		0x8e1abd2a98b81ef9LL,0xf63ddcb18f5f1339LL,0x43989dd7932e8d10LL,0x3bbffc4c84c980d0LL,0x2fc87ca031980278LL,0x57ef1d3b267f0fb8LL,0xe24a5c5d3a0e9191LL,0x9a6d3dc62de99c51LL,
		0x1d86167414c44609LL,0x65a177ef03234bc9LL,0xd00436891f52d5e0LL,0xa823571208b5d820LL,0xbc54d7febde45a88LL,0xc473b665aa035748LL,0x71d6f703b672c961LL,0x09f19698a195c4a1LL,
		0x5ff939f9d101c84aLL,0x27de5862c6e6c58aLL,0x927b1904da975ba3LL,0xea5c789fcd705663LL,0xfe2bf8737821d4cbLL,0x860c99e86fc6d90bLL,0x33a9d88e73b74722LL,0x4b8eb91564504ae2LL,
		0xcc6592a75d7d90baLL,0xb442f33c4a9a9d7aLL,0x01e7b25a56eb0353LL,0x79c0d3c1410c0e93LL,0x6db7532df45d8c3bLL,0x159032b6e3ba81fbLL,0xa03573d0ffcb1fd2LL,0xd812124be82c1212LL,
		0xd0df269400221598LL,0xa8f8470f17c51858LL,0x1d5d06690bb48671LL,0x657a67f21c538bb1LL,0x710de71ea9020919LL,0x092a8685bee504d9LL,0xbc8fc7e3a2949af0LL,0xc4a8a678b5739730LL,
		0x43438dca8c5e4d68LL,0x3b64ec519bb940a8LL,0x8ec1ad3787c8de81LL,0xf6e6ccac902fd341LL,0xe2914c40257e51e9LL,0x9ab62ddb32995c29LL,0x2f136cbd2ee8c200LL,0x57340d26390fcfc0LL,
		0xc718608b513e52bdLL,0xbf3f011046d95f7dLL,0x0a9a40765aa8c154LL,0x72bd21ed4d4fcc94LL,0x66caa101f81e4e3cLL,0x1eedc09aeff943fcLL,0xab4881fcf388ddd5LL,0xd36fe067e46fd015LL,
		0x5484cbd5dd420a4dLL,0x2ca3aa4ecaa5078dLL,0x9906eb28d6d499a4LL,0xe1218ab3c1339464LL,0xf5560a5f746216ccLL,0x8d716bc463851b0cLL,0x38d42aa27ff48525LL,0x40f34b39681388e5LL,
		0x483e7fe6801d8f6fLL,0x30191e7d97fa82afLL,0x85bc5f1b8b8b1c86LL,0xfd9b3e809c6c1146LL,0xe9ecbe6c293d93eeLL,0x91cbdff73eda9e2eLL,0x246e9e9122ab0007LL,0x5c49ff0a354c0dc7LL,
		0xdba2d4b80c61d79fLL,0xa385b5231b86da5fLL,0x1620f44507f74476LL,0x6e0795de101049b6LL,0x7a701532a541cb1eLL,0x025774a9b2a6c6deLL,0xb7f235cfaed758f7LL,0xcfd55454b9305537LL,
		0xc624c2cc18a59196LL,0xbe03a3570f429c56LL,0x0ba6e2311333027fLL,0x738183aa04d40fbfLL,0x67f60346b1858d17LL,0x1fd162dda66280d7LL,0xaa7423bbba131efeLL,0xd2534220adf4133eLL,
		0x55b8699294d9c966LL,0x2d9f0809833ec4a6LL,0x983a496f9f4f5a8fLL,0xe01d28f488a8574fLL,0xf46aa8183df9d5e7LL,0x8c4dc9832a1ed827LL,0x39e888e5366f460eLL,0x41cfe97e21884bceLL,
		0x4902dda1c9864c44LL,0x3125bc3ade614184LL,0x8480fd5cc210dfadLL,0xfca79cc7d5f7d26dLL,0xe8d01c2b60a650c5LL,0x90f77db077415d05LL,0x25523cd66b30c32cLL,0x5d755d4d7cd7ceecLL,
		0xda9e76ff45fa14b4LL,0xa2b91764521d1974LL,0x171c56024e6c875dLL,0x6f3b3799598b8a9dLL,0x7b4cb775ecda0835LL,0x036bd6eefb3d05f5LL,0xb6ce9788e74c9bdcLL,0xcee9f613f0ab961cLL,
		0x5ec59bbe989a0b61LL,0x26e2fa258f7d06a1LL,0x9347bb43930c9888LL,0xeb60dad884eb9548LL,0xff175a3431ba17e0LL,0x87303baf265d1a20LL,0x32957ac93a2c8409LL,0x4ab21b522dcb89c9LL,
		0xcd5930e014e65391LL,0xb57e517b03015e51LL,0x00db101d1f70c078LL,0x78fc71860897cdb8LL,0x6c8bf16abdc64f10LL,0x14ac90f1aa2142d0LL,0xa109d197b650dcf9LL,0xd92eb00ca1b7d139LL,
		0xd1e384d349b9d6b3LL,0xa9c4e5485e5edb73LL,0x1c61a42e422f455aLL,0x6446c5b555c8489aLL,0x70314559e099ca32LL,0x081624c2f77ec7f2LL,0xbdb365a4eb0f59dbLL,0xc594043ffce8541bLL,
		0x427f2f8dc5c58e43LL,0x3a584e16d2228383LL,0x8ffd0f70ce531daaLL,0xf7da6eebd9b4106aLL,0xe3adee076ce592c2LL,0x9b8a8f9c7b029f02LL,0x2e2fcefa6773012bLL,0x5608af6170940cebLL,
	},
	{//3
		0x0000000000000000LL,0x2c87c0b40c49b2efLL,0x30deb96bfef92782LL,0x1c5979dff2b0956dLL,0xb4abd6ea5e716242LL,0x982c165e5238d0adLL,0x84756f81a08845c0LL,0xa8f2af35acc1f72fLL,
		0x862bf27e78f0a78bLL,0xaaac32ca74b91564LL,0xb6f54b1586098009LL,0x9a728ba18a4032e6LL,0x328024942681c5c9LL,0x1e07e4202ac87726LL,0x025e9dffd878e24bLL,0x2ed95d4bd43150a4LL,
		0xcfac7ae239ba9ef6LL,0xe32bba5635f32c19LL,0xff72c389c743b974LL,0xd3f5033dcb0a0b9bLL,0x7b07ac0867cbfcb4LL,0x57806cbc6b824e5bLL,0x4bd915639932db36LL,0x675ed5d7957b69d9LL,
		0x4987889c414a397dLL,0x650048284d038b92LL,0x795931f7bfb31effLL,0x55def143b3faac10LL,0xfd2c5e761f3b5b3fLL,0xd1ab9ec21372e9d0LL,0xcdf2e71de1c27cbdLL,0xe17527a9ed8bce52LL,
		0x0802cbf5a0805323LL,0x24850b41acc9e1ccLL,0x38dc729e5e7974a1LL,0x145bb22a5230c64eLL,0xbca91d1ffef13161LL,0x902eddabf2b8838eLL,0x8c77a474000816e3LL,0xa0f064c00c41a40cLL,
		0x8e29398bd870f4a8LL,0xa2aef93fd4394647LL,0xbef780e02689d32aLL,0x927040542ac061c5LL,0x3a82ef61860196eaLL,0x16052fd58a482405LL,0x0a5c560a78f8b168LL,0x26db96be74b10387LL,
		0xc7aeb117993acdd5LL,0xeb2971a395737f3aLL,0xf770087c67c3ea57LL,0xdbf7c8c86b8a58b8LL,0x730567fdc74baf97LL,0x5f82a749cb021d78LL,0x43dbde9639b28815LL,0x6f5c1e2235fb3afaLL,
		0x41854369e1ca6a5eLL,0x6d0283dded83d8b1LL,0x715bfa021f334ddcLL,0x5ddc3ab6137aff33LL,0xf52e9583bfbb081cLL,0xd9a95537b3f2baf3LL,0xc5f02ce841422f9eLL,0xe977ec5c4d0b9d71LL,
		0x910ee81e20b14135LL,0xbd8928aa2cf8f3daLL,0xa1d05175de4866b7LL,0x8d5791c1d201d458LL,0x25a53ef47ec02377LL,0x0922fe4072899198LL,0x157b879f803904f5LL,0x39fc472b8c70b61aLL,
		0x17251a605841e6beLL,0x3ba2dad454085451LL,0x27fba30ba6b8c13cLL,0x0b7c63bfaaf173d3LL,0xa38ecc8a063084fcLL,0x8f090c3e0a793613LL,0x935075e1f8c9a37eLL,0xbfd7b555f4801191LL,
		0x5ea292fc190bdfc3LL,0x7225524815426d2cLL,0x6e7c2b97e7f2f841LL,0x42fbeb23ebbb4aaeLL,0xea094416477abd81LL,0xc68e84a24b330f6eLL,0xdad7fd7db9839a03LL,0xf6503dc9b5ca28ecLL,
		0xd889608261fb7848LL,0xf40ea0366db2caa7LL,0xe857d9e99f025fcaLL,0xc4d0195d934bed25LL,0x6c22b6683f8a1a0aLL,0x40a576dc33c3a8e5LL,0x5cfc0f03c1733d88LL,0x707bcfb7cd3a8f67LL,
		0x990c23eb80311216LL,0xb58be35f8c78a0f9LL,0xa9d29a807ec83594LL,0x85555a347281877bLL,0x2da7f501de407054LL,0x012035b5d209c2bbLL,0x1d794c6a20b957d6LL,0x31fe8cde2cf0e539LL,
		0x1f27d195f8c1b59dLL,0x33a01121f4880772LL,0x2ff968fe0638921fLL,0x037ea84a0a7120f0LL,0xab8c077fa6b0d7dfLL,0x870bc7cbaaf96530LL,0x9b52be145849f05dLL,0xb7d57ea0540042b2LL,
		0x56a05909b98b8ce0LL,0x7a2799bdb5c23e0fLL,0x667ee0624772ab62LL,0x4af920d64b3b198dLL,0xe20b8fe3e7faeea2LL,0xce8c4f57ebb35c4dLL,0xd2d536881903c920LL,0xfe52f63c154a7bcfLL,
		0xd08bab77c17b2b6bLL,0xfc0c6bc3cd329984LL,0xe055121c3f820ce9LL,0xccd2d2a833cbbe06LL,0x64207d9d9f0a4929LL,0x48a7bd299343fbc6LL,0x54fec4f661f36eabLL,0x787904426dbadc44LL,
		0xcdddf4715cec947fLL,0xe15a34c550a52690LL,0xfd034d1aa215b3fdLL,0xd1848daeae5c0112LL,0x7976229b029df63dLL,0x55f1e22f0ed444d2LL,0x49a89bf0fc64d1bfLL,0x652f5b44f02d6350LL,
		0x4bf6060f241c33f4LL,0x6771c6bb2855811bLL,0x7b28bf64dae51476LL,0x57af7fd0d6aca699LL,0xff5dd0e57a6d51b6LL,0xd3da10517624e359LL,0xcf83698e84947634LL,0xe304a93a88ddc4dbLL,
		0x02718e9365560a89LL,0x2ef64e27691fb866LL,0x32af37f89baf2d0bLL,0x1e28f74c97e69fe4LL,0xb6da58793b2768cbLL,0x9a5d98cd376eda24LL,0x8604e112c5de4f49LL,0xaa8321a6c997fda6LL,
		0x845a7ced1da6ad02LL,0xa8ddbc5911ef1fedLL,0xb484c586e35f8a80LL,0x98030532ef16386fLL,0x30f1aa0743d7cf40LL,0x1c766ab34f9e7dafLL,0x002f136cbd2ee8c2LL,0x2ca8d3d8b1675a2dLL,
		0xc5df3f84fc6cc75cLL,0xe958ff30f02575b3LL,0xf50186ef0295e0deLL,0xd986465b0edc5231LL,0x7174e96ea21da51eLL,0x5df329daae5417f1LL,0x41aa50055ce4829cLL,0x6d2d90b150ad3073LL,
		0x43f4cdfa849c60d7LL,0x6f730d4e88d5d238LL,0x732a74917a654755LL,0x5fadb425762cf5baLL,0xf75f1b10daed0295LL,0xdbd8dba4d6a4b07aLL,0xc781a27b24142517LL,0xeb0662cf285d97f8LL,
		0x0a734566c5d659aaLL,0x26f485d2c99feb45LL,0x3aadfc0d3b2f7e28LL,0x162a3cb93766ccc7LL,0xbed8938c9ba73be8LL,0x925f533897ee8907LL,0x8e062ae7655e1c6aLL,0xa281ea536917ae85LL,
		0x8c58b718bd26fe21LL,0xa0df77acb16f4cceLL,0xbc860e7343dfd9a3LL,0x9001cec74f966b4cLL,0x38f361f2e3579c63LL,0x1474a146ef1e2e8cLL,0x082dd8991daebbe1LL,0x24aa182d11e7090eLL,
		0x5cd31c6f7c5dd54aLL,0x7054dcdb701467a5LL,0x6c0da50482a4f2c8LL,0x408a65b08eed4027LL,0xe878ca85222cb708LL,0xc4ff0a312e6505e7LL,0xd8a673eedcd5908aLL,0xf421b35ad09c2265LL,
		0xdaf8ee1104ad72c1LL,0xf67f2ea508e4c02eLL,0xea26577afa545543LL,0xc6a197cef61de7acLL,0x6e5338fb5adc1083LL,0x42d4f84f5695a26cLL,0x5e8d8190a4253701LL,0x720a4124a86c85eeLL,
		0x937f668d45e74bbcLL,0xbff8a63949aef953LL,0xa3a1dfe6bb1e6c3eLL,0x8f261f52b757ded1LL,0x27d4b0671b9629feLL,0x0b5370d317df9b11LL,0x170a090ce56f0e7cLL,0x3b8dc9b8e926bc93LL,
		0x155494f33d17ec37LL,0x39d35447315e5ed8LL,0x258a2d98c3eecbb5LL,0x090ded2ccfa7795aLL,0xa1ff421963668e75LL,0x8d7882ad6f2f3c9aLL,0x9121fb729d9fa9f7LL,0xbda63bc691d61b18LL,
		0x54d1d79adcdd8669LL,0x7856172ed0943486LL,0x640f6ef12224a1ebLL,0x4888ae452e6d1304LL,0xe07a017082ace42bLL,0xccfdc1c48ee556c4LL,0xd0a4b81b7c55c3a9LL,0xfc2378af701c7146LL,
		0xd2fa25e4a42d21e2LL,0xfe7de550a864930dLL,0xe2249c8f5ad40660LL,0xcea35c3b569db48fLL,0x6651f30efa5c43a0LL,0x4ad633baf615f14fLL,0x568f4a6504a56422LL,0x7a088ad108ecd6cdLL,
		0x9b7dad78e567189fLL,0xb7fa6dcce92eaa70LL,0xaba314131b9e3f1dLL,0x8724d4a717d78df2LL,0x2fd67b92bb167addLL,0x0351bb26b75fc832LL,0x1f08c2f945ef5d5fLL,0x338f024d49a6efb0LL,
		0x1d565f069d97bf14LL,0x31d19fb291de0dfbLL,0x2d88e66d636e9896LL,0x010f26d96f272a79LL,0xa9fd89ecc3e6dd56LL,0x857a4958cfaf6fb9LL,0x992330873d1ffad4LL,0xb5a4f0333156483bLL,
	}
};


#	define A(x) ((x) & 0xFF)
#	define B(x) (((x) >> 8) & 0xFF)
#	define C(x) (((x) >> 16) & 0xFF)
#	define D(x) ((x) >> 24)

#	define S8(x) ((x) >> 8)
#	define S32(x) ((x) >> 32)
#	define A1 A

// static void Init()
// {
	// for (unsigned int i = 0; i <= 0xFF; i++) 
	// { 
		// // for Slicing-by-4 and Slicing-by-8 
		// crc64_tab[1][i] = (crc64_tab[0][i] >> 8) ^ crc64_tab[0][crc64_tab[0][i] & 0xFF]; 
		// crc64_tab[2][i] = (crc64_tab[1][i] >> 8) ^ crc64_tab[0][crc64_tab[1][i] & 0xFF]; 
		// crc64_tab[3][i] = (crc64_tab[2][i] >> 8) ^ crc64_tab[0][crc64_tab[2][i] & 0xFF]; 
		// // only Slicing-by-8 
		// /*
		// crc32Lookup[4][i] = (crc32Lookup[3][i] >> 8) ^ crc32Lookup[0][crc32Lookup[3][i] & 0xFF]; 
		// crc32Lookup[5][i] = (crc32Lookup[4][i] >> 8) ^ crc32Lookup[0][crc32Lookup[4][i] & 0xFF]; 
		// crc32Lookup[6][i] = (crc32Lookup[5][i] >> 8) ^ crc32Lookup[0][crc32Lookup[5][i] & 0xFF]; 
		// crc32Lookup[7][i] = (crc32Lookup[6][i] >> 8) ^ crc32Lookup[0][crc32Lookup[6][i] & 0xFF]; 
		// */
	// } 
// }

FORCEINLINE UINT64 update_crc64(UINT64 crc, const char * s, size_t l)
{
	const UINT8* b = (const UINT8*)s;
	/*
	for( size_t j = 0; j < l; j++) 
	{
	UINT8 byte = b[j];
	crc = crc64_tab[(UINT8)crc ^ byte] ^ (crc >> 8);
	}

	return crc;
	*/

	// for (unsigned int i = 0; i <= 0xFF; i++) 
	// { 
		// // for Slicing-by-4 and Slicing-by-8 
		// crc64_tab[1][i] = (crc64_tab[0][i] >> 8) ^ crc64_tab[0][crc64_tab[0][i] & 0xFF]; 
		// crc64_tab[2][i] = (crc64_tab[1][i] >> 8) ^ crc64_tab[0][crc64_tab[1][i] & 0xFF]; 
		// crc64_tab[3][i] = (crc64_tab[2][i] >> 8) ^ crc64_tab[0][crc64_tab[2][i] & 0xFF]; 
		// // only Slicing-by-8 
		// /*
		// crc32Lookup[4][i] = (crc32Lookup[3][i] >> 8) ^ crc32Lookup[0][crc32Lookup[3][i] & 0xFF]; 
		// crc32Lookup[5][i] = (crc32Lookup[4][i] >> 8) ^ crc32Lookup[0][crc32Lookup[4][i] & 0xFF]; 
		// crc32Lookup[6][i] = (crc32Lookup[5][i] >> 8) ^ crc32Lookup[0][crc32Lookup[5][i] & 0xFF]; 
		// crc32Lookup[7][i] = (crc32Lookup[6][i] >> 8) ^ crc32Lookup[0][crc32Lookup[6][i] & 0xFF]; 
		// */
	// } 
	

	UINT64 _crc = crc;
	
	if (l > 4)
	{
		while ((uintptr_t)(b) & 3) {
			_crc = crc64_tab[0][*b++ ^ A1(_crc)] ^ S8(_crc);
			--l;
		}

		const BYTE *const limit = b + (l & ~(size_t)(3));
		l &= (size_t)(3);

		while (b < limit) {

			const UINT32 tmp = _crc ^ RS_SWAPDWORD(*(const UINT32 *)(b));
			b += 4;

			_crc =	crc64_tab[3][A(tmp)] ^
					crc64_tab[2][B(tmp)] ^
					//S32(_crc) ^
					crc64_tab[1][C(tmp)] ^
					crc64_tab[0][D(tmp)] ^
					S32(_crc);
		}
	}

	while (l-- != 0)
		_crc = crc64_tab[0][*b++ ^ A1(_crc)] ^ S8(_crc);
		


	

	/*
	UINT32* current = (UINT32*) s;
	UINT64 _crc = crc;
	// process four bytes at once
	while (l >= 4)
	{
		_crc ^= *current++;
		_crc  = crc64_tab[3][ _crc      & 0xFF] ^
			crc64_tab[2][(_crc>>8 ) & 0xFF] ^
			crc64_tab[1][(_crc>>16) & 0xFF] ^
			crc64_tab[0][ (_crc>>24) & 0xFF]^
		    _crc>>32;
		l -= 4;
	}
	const unsigned char* currentChar = (unsigned char*) current;
	// remaining 1 to 3 bytes
	while (l--)
		_crc = (_crc >> 8) ^ crc64_tab[0][(_crc & 0xFF) ^ *currentChar++];
		*/
	
	return _crc;


}

UINT64 std_crc64(const char *data, size_t lens)
{
	return ~update_crc64(0xFFFFFFFFFFFFFFFFLL, data, (DWORD)lens);
}